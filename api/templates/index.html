<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T√≠nh To√°n ƒêi·ªán M·∫∑t Tr·ªùi</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary-color: #2ecc71; --secondary-color: #27ae60; --bg-color: #f0f2f5; }
        body { font-family: 'Roboto', sans-serif; background-color: var(--bg-color); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 20px;}
        .card { background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 450px; }
        h2 { text-align: center; color: var(--secondary-color); margin-bottom: 1.5rem; }
        .form-group { margin-bottom: 1.2rem; }
        label { display: block; margin-bottom: 0.5rem; font-weight: 500; }
        select, input { width: 100%; padding: 12px; border: 2px solid #e1e1e1; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
        button { width: 100%; padding: 14px; background-color: var(--primary-color); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 10px;}
        button:hover { background-color: var(--secondary-color); }
        .result-box { margin-top: 2rem; background: #e8f8f5; border: 1px solid #d1f2eb; padding: 1.5rem; border-radius: 8px; text-align: center; }
        .result-value { font-size: 32px; font-weight: bold; color: var(--secondary-color); margin: 10px 0; }
        
        /* Class ƒë·ªÉ ·∫©n hi·ªán √¥ nh·∫≠p gi√° */
        .hidden { display: none; }
    </style>
</head>
<body>

    <div class="card">
        <h2>‚ö° T√≠nh C√¥ng Su·∫•t Solar</h2>
        
        <form method="POST">
            <div class="form-group">
                <label for="loai_hinh">Lo·∫°i h√¨nh l·∫Øp ƒë·∫∑t:</label>
                <select name="loai_hinh" id="loai_hinh" onchange="toggleGiaDien()">
                    <option value="can_ho" {% if du_lieu_nhap.loai_hinh == 'can_ho' %}selected{% endif %}>üè° CƒÉn h·ªô gia ƒë√¨nh (B·∫≠c thang EVN)</option>
                    <option value="kinh_doanh" {% if du_lieu_nhap.loai_hinh == 'kinh_doanh' %}selected{% endif %}>üè¢ Kinh doanh</option>
                    <option value="san_xuat" {% if du_lieu_nhap.loai_hinh == 'san_xuat' %}selected{% endif %}>üè≠ S·∫£n xu·∫•t</option>
                </select>
            </div>

            <div class="form-group">
                <label for="tien_dien">T·ªïng ti·ªÅn ƒëi·ªán th√°ng (VNƒê):</label>
                <input type="number" name="tien_dien" placeholder="V√≠ d·ª•: 2000000" value="{{ du_lieu_nhap.tien_dien }}" required>
            </div>

            <div class="form-group hidden" id="box-gia-dien">
                <label for="gia_dien_khac">Gi√° ƒëi·ªán trung b√¨nh (VNƒê/kWh):</label>
                <input type="number" name="gia_dien_khac" id="gia_dien_khac" placeholder="V√≠ d·ª•: 2500" value="{{ du_lieu_nhap.gia_dien_khac }}">
            </div>

            <button type="submit">T√≠nh to√°n ngay</button>
        </form>

        {% if ket_qua is not none %}
        <div class="result-box">
            <div>C√¥ng su·∫•t ki·∫øn ngh·ªã:</div>
            <div class="result-value">{{ ket_qua }} kWp</div>
        </div>
        {% endif %}
    </div>

    <script>
        function toggleGiaDien() {
            var loaiHinh = document.getElementById("loai_hinh").value;
            var boxGiaDien = document.getElementById("box-gia-dien");
            var inputGiaDien = document.getElementById("gia_dien_khac");

            if (loaiHinh === "can_ho") {
                boxGiaDien.classList.add("hidden"); // ·∫®n ƒëi
                inputGiaDien.required = false;      // Kh√¥ng b·∫Øt bu·ªôc nh·∫≠p
            } else {
                boxGiaDien.classList.remove("hidden"); // Hi·ªán l√™n
                inputGiaDien.required = true;          // B·∫Øt bu·ªôc nh·∫≠p
            }
        }

        // Ch·∫°y h√†m n√†y 1 l·∫ßn khi trang v·ª´a t·∫£i xong ƒë·ªÉ set ƒë√∫ng tr·∫°ng th√°i c≈©
        window.onload = toggleGiaDien;
    </script>
</body>
</html>